#                          label=c("Sunrise","Sunset","Sunrise")
) + coord_cartesian(xlim=c(-1,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="Normalized Time of Day"
) + theme_minimal()
NTDF = data.frame(Obs=histc(thisSite$NormTime,edges=NTedges)$cnt[1:20]/dim(thisSite)[1],
Pres=histc(presDF$NormTime,edges=NTedges)$cnt[1:20]/dim(presDF)[1],
Edges=seq(-.95,0.95,by=0.1))
ggplot(NTDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
# ) + scale_x_continuous(breaks=c(-1,0,1),
#                          label=c("Sunrise","Sunset","Sunrise")
) + coord_cartesian(xlim=c(-1,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="Normalized Time of Day"
) + theme_minimal()
JDedges = seq(0,365,by=7)
JDedges = seq(1,365,by=7)
JDedges
JDDF = data.frame(Obs=histc(thisSite$JulianDay,edges=JDedges)$cnt[1:52]/dim(thisSite)[1],
Pres=histc(presDF$JulianDay,edges=JDedges)$cnt[1:52]/dim(presDF)[1],
Edges=seq(4.5,368.5,by=7))
JDDF = data.frame(Obs=histc(thisSite$JulianDay,edges=JDedges)$cnt[1:52]/dim(thisSite)[1],
Pres=histc(presDF$JulianDay,edges=JDedges)$cnt[1:52]/dim(presDF)[1],
Edges=seq(4.5,361.5,by=7))
JDedges = seq(1,365,by=7)
JDDF = data.frame(Obs=histc(thisSite$JulianDay,edges=JDedges)$cnt[1:52]/dim(thisSite)[1],
Pres=histc(presDF$JulianDay,edges=JDedges)$cnt[1:52]/dim(presDF)[1],
Edges=seq(4.5,361.5,by=7))
ggplot(JDDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(1,32,60,91,121,152,182,213,244,274,305,335),
label=c("J","F","M","A","M","J","J","A","S","O","N","D")
) + coord_cartesian(xlim=c(1,365)
) + labs(y="Normalized Presence Counts",x=NULL,title="Julian Day"
) + theme_minimal()
ggplot(presDF,aes(x=JulianDay)
)+geom_histogram(aes(y=..count../dim(presDF)[1]),
fill='#66B2FF',
binwidth = 7,
alpha=0.5
) + scale_x_continuous(breaks=c(1,32,60,91,121,152,182,213,244,274,305,335),
label=c("J","F","M","A","M","J","J","A","S","O","N","D")
) + coord_cartesian(xlim=c(1,365)
) + labs(y=NULL,x=NULL,title="Julian Day"
) + theme_minimal()
Yredges = seq(0.5,4.5,by=1)
YrDF = data.frame(Obs=histc(thisSite$StudyYear,edges=Yredges)$cnt[1:4]/dim(thisSite)[1],
Pres=histc(presDF$StudyYear,edges=Yredges)$cnt[1:4]/dim(presDF)[1],
Edges=seq(1,4,by=1))
ggplot(YrDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(1,2,3,4),
) + coord_cartesian(xlim=c(0.5,4.5)
) + labs(y="Normalized Presence Counts",x=NULL,title="Study Year"
) + theme_minimal()
Yredges = seq(0.5,3.5,by=1)
YrDF = data.frame(Obs=histc(thisSite$StudyYear,edges=Yredges)$cnt[1:3]/dim(thisSite)[1],
Pres=histc(presDF$StudyYear,edges=Yredges)$cnt[1:3]/dim(presDF)[1],
Edges=seq(1,3,by=1))
ggplot(YrDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(1,2,3),
) + coord_cartesian(xlim=c(0.5,3.5)
) + labs(y="Normalized Presence Counts",x=NULL,title="Study Year"
) + theme_minimal()
NTedges = seq(-1,1,by=0.1)
NTDF = data.frame(Obs=histc(thisSite$NormTime,edges=NTedges)$cnt[1:20]/dim(thisSite)[1],
Pres=histc(presDF$NormTime,edges=NTedges)$cnt[1:20]/dim(presDF)[1],
Edges=seq(-.95,0.95,by=0.1))
NT = ggplot(NTDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(-1,0,1),
label=c("Sunrise","Sunset","Sunrise")
) + coord_cartesian(xlim=c(-1,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="Normalized Time of Day"
) + theme_minimal()
DPedges = seq(0.5,4.5,by=1)
DPDF = data.frame(Obs=histc(thisSite$DayPhase,edges=DPedges)$cnt[1:4]/dim(thisSite)[1],
Pres=histc(presDF$DayPhase,edges=DPedges)$cnt[1:4]/dim(presDF)[1],
Edges=seq(1,4,by=1))
DP = ggplot(DPDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(1,2,3,4),
label=c("Dawn","Day","Dusk","Night")
) + coord_cartesian(xlim=c(0.5,4.5)
) + labs(y="Normalized Presence Counts",x=NULL,title="Day Phase"
) + theme_minimal()
JDedges = seq(1,365,by=7)
JDDF = data.frame(Obs=histc(thisSite$JulianDay,edges=JDedges)$cnt[1:52]/dim(thisSite)[1],
Pres=histc(presDF$JulianDay,edges=JDedges)$cnt[1:52]/dim(presDF)[1],
Edges=seq(4.5,361.5,by=7))
JD = ggplot(JDDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(1,32,60,91,121,152,182,213,244,274,305,335),
label=c("J","F","M","A","M","J","J","A","S","O","N","D")
) + coord_cartesian(xlim=c(1,365)
) + labs(y="Normalized Presence Counts",x=NULL,title="Julian Day"
) + theme_minimal()
Yredges = seq(0.5,3.5,by=1)
YrDF = data.frame(Obs=histc(thisSite$StudyYear,edges=Yredges)$cnt[1:3]/dim(thisSite)[1],
Pres=histc(presDF$StudyYear,edges=Yredges)$cnt[1:3]/dim(presDF)[1],
Edges=seq(1,3,by=1))
Yr = ggplot(YrDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(1,2,3),
) + coord_cartesian(xlim=c(0.5,3.5)
) + labs(y="Normalized Presence Counts",x=NULL,title="Study Year"
) + theme_minimal()
while (dev.cur()>1) {dev.off()}
grid.arrange(NT,DP,JD,Yr,ncol=2,nrow=2,top=paste(CTname,'at',site))
png(file=paste(dielDir,'/',CTname,'/',site,"_TempHist.png",sep=""),width = 800, height = 800, units = "px")
grid.arrange(NT,DP,JD,Yr,ncol=2,nrow=2,top=paste(CTname,'at',site))
while (dev.cur()>1) {dev.off()}
JDedges = seq(1,365,by=14)
JDedges = seq(1,365,by=14)
JDDF = data.frame(Obs=histc(thisSite$JulianDay,edges=JDedges)$cnt[1:26]/dim(thisSite)[1],
Pres=histc(presDF$JulianDay,edges=JDedges)$cnt[1:26]/dim(presDF)[1],
Edges=seq(4.5,361.5,by=14))
ggplot(JDDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(1,32,60,91,121,152,182,213,244,274,305,335),
label=c("J","F","M","A","M","J","J","A","S","O","N","D")
) + coord_cartesian(xlim=c(1,365)
) + labs(y="Normalized Presence Counts",x=NULL,title="Julian Day"
) + theme_minimal()
masterLun = data.frame(read.csv(lunList[i]))
CTname = str_remove(lunList[i],paste(DFDir,'/',sep="")) # get the species/CT name
site = str_remove(CTname,paste("_",int,"_MasterLun.csv",sep=""))
site = sub(".*_","",site)
CTname = sub("_.*","",CTname)
if (str_detect(CTname,"Atl")){
CTname = "Gervais"
}
masterLun$MoonAltitude = masterLun$MoonAltitude*(180/pi) # convert altitude from radians to degrees
masterLun$MoonPres = as.numeric(as.factor(masterLun$MoonPres))
View(masterLun)
View(masterLun)
pres = which(masterLun$NightPres>0)
nightPresDF = masterLun[pres,]
PHedges = seq(-1,1,by=0.1)
PHDF = data.frame(Obs=histc(thisSite$MoonPhase,edges=PHedges)$cnt[1:20]/dim(thisSite)[1],
Pres=histc(presDF$MoonPhase,edges=PHedges)$cnt[1:20]/dim(presDF)[1],
Edges=seq(-.95,0.95,by=0.1))
tyepof(masterLun$MoonPhase)
typeof(masterLun$MoonPhase)
PHedges = seq(-1,1,by=0.1)
PHDF = data.frame(Obs=histc(masterLun$MoonPhase,edges=PHedges)$cnt[1:20]/dim(thisSite)[1],
Pres=histc(nightPresDF$MoonPhase,edges=PHedges)$cnt[1:20]/dim(presDF)[1],
Edges=seq(-.95,0.95,by=0.1))
ggplot(PHDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(-1,0,1),
label=c("New Moon","Full Moon","New Moon")
) + coord_cartesian(xlim=c(-1,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="MoonPhase"
) + theme_minimal()
ggplot(PHDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(0,1),
label=c("New Moon","Full Moon","New Moon")
) + coord_cartesian(xlim=c(0,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="MoonPhase"
) + theme_minimal()
ggplot(PHDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(0,0.5,1),
label=c("New Moon","Full Moon","New Moon")
) + coord_cartesian(xlim=c(0,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="MoonPhase"
) + theme_minimal()
PHedges = seq(0,1,by=0.1)
PHDF = data.frame(Obs=histc(masterLun$MoonPhase,edges=PHedges)$cnt[1:20]/dim(thisSite)[1],
Pres=histc(nightPresDF$MoonPhase,edges=PHedges)$cnt[1:20]/dim(presDF)[1],
Edges=seq(-.95,0.95,by=0.1))
ggplot(PHDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(0,0.5,1),
label=c("New Moon","Full Moon","New Moon")
) + coord_cartesian(xlim=c(0,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="MoonPhase"
) + theme_minimal()
PHedges = seq(0,1,by=0.05)
PHedges = seq(0,1,by=0.05)
PHDF = data.frame(Obs=histc(masterLun$MoonPhase,edges=PHedges)$cnt[1:20]/dim(thisSite)[1],
Pres=histc(nightPresDF$MoonPhase,edges=PHedges)$cnt[1:20]/dim(presDF)[1],
Edges=seq(-.975,0.975,by=0.05))
ggplot(PHDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(0,0.5,1),
label=c("New Moon","Full Moon","New Moon")
) + coord_cartesian(xlim=c(0,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="MoonPhase"
) + theme_minimal()
ggplot(PHDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
# ) + scale_x_continuous(breaks=c(0,0.5,1),
#                        label=c("New Moon","Full Moon","New Moon")
) + coord_cartesian(xlim=c(0,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="MoonPhase"
) + theme_minimal()
PHedges
PHDF = data.frame(Obs=histc(masterLun$MoonPhase,edges=PHedges)$cnt[1:20]/dim(thisSite)[1],
Pres=histc(nightPresDF$MoonPhase,edges=PHedges)$cnt[1:20]/dim(presDF)[1],
Edges=seq(0.025,0.975,by=0.05))
ggplot(PHDF
)+geom_col(aes(x=Edges,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
# ) + scale_x_continuous(breaks=c(0,0.5,1),
#                        label=c("New Moon","Full Moon","New Moon")
) + coord_cartesian(xlim=c(0,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="MoonPhase"
) + theme_minimal()
PHedges
View(PHDF)
ggplot(PHDF
)+geom_col(aes(x=BinCenter,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(0,0.5,1),
label=c("New Moon","Full Moon","New Moon")
) + coord_cartesian(xlim=c(0,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="MoonPhase"
) + theme_minimal()
PHedges = seq(0,1,by=0.05)
PHDF = data.frame(Obs=histc(masterLun$MoonPhase,edges=PHedges)$cnt[1:20]/dim(thisSite)[1],
Pres=histc(nightPresDF$MoonPhase,edges=PHedges)$cnt[1:20]/dim(presDF)[1],
BinCenter=seq(0.025,0.975,by=0.05))
ggplot(PHDF
)+geom_col(aes(x=BinCenter,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=Edges,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(0,0.5,1),
label=c("New Moon","Full Moon","New Moon")
) + coord_cartesian(xlim=c(0,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="MoonPhase"
) + theme_minimal()
ggplot(PHDF
)+geom_col(aes(x=BinCenter,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=BinCenter,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(0,0.5,1),
label=c("New Moon","Full Moon","New Moon")
) + coord_cartesian(xlim=c(0,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="MoonPhase"
) + theme_minimal()
PHedges = seq(0,1,by=0.05)
PHDF = data.frame(Obs=histc(masterLun$MoonPhase,edges=PHedges)$cnt[1:20]/dim(masterLun)[1],
Pres=histc(nightPresDF$MoonPhase,edges=PHedges)$cnt[1:20]/dim(nightPresDF)[1],
BinCenter=seq(0.025,0.975,by=0.05))
ggplot(PHDF
)+geom_col(aes(x=BinCenter,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=BinCenter,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(0,0.5,1),
label=c("New Moon","Full Moon","New Moon")
) + coord_cartesian(xlim=c(0,1)
) + labs(y="Normalized Presence Counts",x=NULL,title="MoonPhase"
) + theme_minimal()
Altedges = seq(-90,90,by=10)
AltDF = data.frame(Obs=histc(masterLun$MoonAltitude,edges=Altedges)$cnt[1:18]/dim(masterLun)[1],
Pres=histc(nightPresDF$MoonPhase,edges=Altedges)$cnt[1:18]/dim(nightPresDF)[1],
BinCenter=seq(-85,85,by=10))
View(AltDF)
Altedges = seq(-90,90,by=10)
AltDF = data.frame(Obs=histc(masterLun$MoonAltitude,edges=Altedges)$cnt[1:18]/dim(masterLun)[1],
Pres=histc(nightPresDF$MoonPhase,edges=Altedges)$cnt[1:18]/dim(nightPresDF)[1],
BinCenter=seq(-85,85,by=10))
ggplot(AltDF
)+geom_col(aes(x=BinCenter,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=BinCenter,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(-45,0,45),
label=c(paste("-45",intToUtf8(176),sep=""),
paste("0",intToUtf8(176),sep=""),
paste("45",intToUtf8(176),sep=""))
) + coord_cartesian(xlim=c(-90,90)
) + labs(y="Normalized Presence Counts",x=NULL,title="Moon Altitude"
) + theme_minimal()
Altedges = seq(-90,90,by=10)
AltDF = data.frame(Obs=histc(masterLun$MoonAltitude,edges=Altedges)$cnt[1:18]/dim(masterLun)[1],
Pres=histc(nightPresDF$MoonAltitude,edges=Altedges)$cnt[1:18]/dim(nightPresDF)[1],
BinCenter=seq(-85,85,by=10))
ggplot(AltDF
)+geom_col(aes(x=BinCenter,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=BinCenter,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(-45,0,45),
label=c(paste("-45",intToUtf8(176),sep=""),
paste("0",intToUtf8(176),sep=""),
paste("45",intToUtf8(176),sep=""))
) + coord_cartesian(xlim=c(-90,90)
) + labs(y="Normalized Presence Counts",x=NULL,title="Moon Altitude"
) + theme_minimal()
ggplot(AltDF
)+geom_col(aes(x=BinCenter,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=BinCenter,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(-90,-45,0,45,90),
label=c(paste("-90",intToUtf8(176),sep=""),
paste("-45",intToUtf8(176),sep=""),
paste("0",intToUtf8(176),sep=""),
paste("45",intToUtf8(176),sep=""),
paste("90",intToUtf8(176),sep=""),)
) + coord_cartesian(xlim=c(-90,90)
) + labs(y="Normalized Presence Counts",x=NULL,title="Moon Altitude"
) + theme_minimal()
ggplot(AltDF
)+geom_col(aes(x=BinCenter,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=BinCenter,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(-90,-45,0,45,90),
label=c(paste("-90",intToUtf8(176),sep=""),
paste("-45",intToUtf8(176),sep=""),
paste("0",intToUtf8(176),sep=""),
paste("45",intToUtf8(176),sep=""),
paste("90",intToUtf8(176),sep=""))
) + coord_cartesian(xlim=c(-90,90)
) + labs(y="Normalized Presence Counts",x=NULL,title="Moon Altitude"
) + theme_minimal()
Presedges = seq(0.5,3.5,by=1)
PresDF = data.frame(Obs=histc(masterLun$MoonPres,edges=Presedges)$cnt[1:3]/dim(masterLun)[1],
Pres=histc(nightPresDF$MoonPres,edges=Presedges)$cnt[1:3]/dim(nightPresDF)[1],
BinCenter=seq(1,3,by=1))
ggplot(PresDF
)+geom_col(aes(x=BinCenter,y=Obs),
fill='#bfbfbf',
alpha=0.6
)+geom_col(aes(x=BinCenter,y=Pres),
fill='#66B2FF',
alpha=0.5
) + scale_x_continuous(breaks=c(1,2,3),
label=c("Before","MoonUp","After")
) + coord_cartesian(xlim=c(0.5,3.5)
) + labs(y="Normalized Presence Counts",x=NULL,title="Moon Presence"
) + theme_minimal()
lunList[i]
Presedges
View(PresDF)
sum(nightPresDF$MoonPres==1)
sum(nightPresDF$MoonPres==2)
sum(nightPresDF$MoonPres==3)
source("D:/Code/Temporal_Analyses/Covar_hists.R", echo=TRUE)
source("D:/Code/Temporal_Analyses/Covar_hists.R", echo=TRUE)
debugSource("D:/Code/Temporal_Analyses/binned_residuals_NP.R", echo=TRUE)
debugSource("D:/Code/Temporal_Analyses/ModelPlotting.R", echo=TRUE)
binned_residuals_NP(tempMod)
debugSource("D:/Code/Temporal_Analyses/ModelPlotting.R", echo=TRUE)
binned_residuals_NP(tempMod)
debugSource("D:/Code/Temporal_Analyses/ModelPlotting.R", echo=TRUE)
binned_residuals_NP(tempMod)
model=tempMod
fv <- stats::fitted(model)
mf <- insight::get_data(model)
View(tempMod)
# mf <- insight::get_data(model)
mf = model$model
View(mf)
.recode_to_zero <- function(x) {
# check if factor
if (is.factor(x) || is.character(x)) {
# try to convert to numeric
x <- .factor_to_numeric(x)
}
# retrieve lowest category
minval <- min(x, na.rm = TRUE)
sapply(x, function(y) y - minval)
}
y <- .recode_to_zero(model$y) - fv
typeof(y)
typeof(fv)
pred <- mf[[term]]
pred <- fv
term=Presence
pred <- mf[[term]]
term="Presence"
pred <- mf[[term]]
pred <- fv
rm(term)
n_bins <- round(sqrt(length(pred))
)
breaks.index <- floor(length(pred) * (1:(n_bins - 1)) / n_bins)
breaks <- unique(c(-Inf, sort(pred)[breaks.index], Inf))
model.binned <- as.numeric(cut(pred, breaks))
d <- suppressWarnings(lapply(1:n_bins, function(.x) {
items <- (1:length(pred))[model.binned == .x]
model.range <- range(pred[items], na.rm = TRUE)
xbar <- mean(pred[items], na.rm = TRUE)
ybar <- mean(y[items], na.rm = TRUE)
n <- length(items)
sdev <- stats::sd(y[items], na.rm = TRUE)
data.frame(
xbar = xbar,
ybar = ybar,
n = n,
x.lo = model.range[1],
x.hi = model.range[2],
se = stats::qnorm(.975) * sdev / sqrt(n),
ci_range = sdev / sqrt(n)
)
}))
binned_residuals_NP(tempMod)
debugSource("D:/Code/Temporal_Analyses/binned_residuals_NP.R", echo=TRUE)
debugSource("D:/Code/Temporal_Analyses/binned_residuals_NP.R", echo=TRUE)
debugSource("D:/Code/Temporal_Analyses/binned_residuals_NP.R", echo=TRUE)
source("binned_residuals_NP.R")
debugSource("D:/Code/Temporal_Analyses/ModelPlotting.R", echo=TRUE)
source("D:/Code/Temporal_Analyses/binned_residuals_NP.R", echo=TRUE)
source("D:/Code/Temporal_Analyses/binned_residuals_NP.R", echo=TRUE)
source("D:/Code/Temporal_Analyses/binned_residuals_NP.R", echo=TRUE)
setwd("D:/Code/Temporal_Analyses")
